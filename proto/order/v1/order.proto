syntax = 'proto3';

import "google/protobuf/timestamp.proto";

package order.v1;

option go_package = "golang/order";

message OrderItem {
  string id = 1;
  string product_uid = 2;
  string product_sn = 3;
  string product_name = 4;
  string ordered_as_sn = 5;

  double quantity_ordered = 6;
  string quantity_unit = 7;

  double total_price = 10;
  double shipped_quantity = 11;
  double back_ordered_quantity = 12;
}

message Address {
  double id = 1;
  string name = 2;
  string line_one = 3;
  string line_two = 4;
  string city = 5;
  string state = 6;
  string postal_code = 7;
  string country = 8;
}
message Customer {
  double id = 1;
  string name = 2;
  string phone_number = 3;
  string email = 4;
}

message CustomerContact {
  string id = 1;
  string name = 3;
  string phone_number = 4;
  string email = 5;
  string title = 6;
}

message SimplifiedShipment {
  string id = 1;
  string order_id = 2[deprecated = true];
  string invoice_id = 3[deprecated = true];
  string carrier_name = 4;
  string carrier_tracking = 5;
}

message BasicOrder {
  string id = 1;
  string status = 2;
  string taker = 3;
  string purchase_order = 4;
  google.protobuf.Timestamp order_date = 5;
  google.protobuf.Timestamp requested_date = 6;
  bool completed = 7;
}

message OrderDetails {
  string id = 1;
  string status = 2;
  string taker = 3;
  string purchase_order = 4;
  Address shipping_address = 5;
  Customer customer = 6;
  CustomerContact contact = 7;
  string delivery_instructions = 8;
}


message PageMetadata {
  int32 prev_cursor = 1;
  int32 next_cursor = 2;
}

enum PageDirection {
  PAGE_DIRECTION_UNSPECIFIED = 0;
  PAGE_DIRECTION_NEXT = 1;
  PAGE_DIRECTION_PREVIOUS = 2;
}
message Filters {
  int32 cursor = 1;
  PageDirection direction = 2;
}
service OrderService {
  rpc ListOrdersByCustomerBranch(ListOrdersByCustomerBranchRequest) returns (ListOrdersByCustomerBranchResponse);
  rpc ListOrdersByCustomer(ListOrdersByCustomerRequest) returns (ListOrdersByCustomerResponse);
  rpc ListOrdersByTaker(ListOrdersByTakerRequest) returns (ListOrdersByTakerResponse);

  // ClerkGetOrder returns the order details for a given order id
  rpc ClerkGetOrder(ClerkGetOrderRequest) returns (ClerkGetOrderResponse);
  // ClerkCreateOrder creates a new order
  rpc ClerkCreateOrder(ClerkCreateOrderRequest) returns (ClerkCreateOrderResponse);
  // ClerkCreateQuote creates a new quote
  rpc ClerkCreateQuote(ClerkCreateQuoteRequest) returns (ClerkCreateQuoteResponse);
  // ClerkGetShipment returns the shipment details for a given shipment id
  rpc ClerkGetShipment(ClerkGetShipmentRequest) returns (ClerkGetShipmentResponse);


  // CustomerGetShipmentsForOrder returns a list of shipment transactions for a given order id
  rpc CustomerGetShipmentsForOrder(CustomerGetShipmentsForOrderRequest) returns (CustomerGetShipmentsForOrderResponse);
  // CustomerGetOrder returns the order details for a given order
  rpc CustomerGetOrder(CustomerGetOrderRequest) returns (CustomerGetOrderResponse);
  // CustomerGetQuote returns the quote details for a given quote
  rpc CustomerGetQuote(CustomerGetQuoteRequest) returns (CustomerGetQuoteResponse);

  rpc CustomerListOrders(CustomerListOrdersRequest) returns (CustomerListOrdersResponse);
}

message CustomerGetOrderRequest {
  string id = 1;
}

message CustomerGetOrderResponse {
  message Item {
    OrderItem base = 1;
  }

  string id = 1;
  repeated Item items = 2;

  string purchase_order = 3;
  string shipping_address_id = 4;
  string shipping_address_name = 5;
  string shipping_address_line_one = 6;
  string shipping_address_line_two = 7;
  string shipping_address_city = 8;
  string shipping_address_state = 9;
  string shipping_address_postal_code = 10;
  string shipping_address_country = 11;

  string delivery_instructions = 12;


  google.protobuf.Timestamp date_placed = 13;

  string taker = 14;


  string customer_id = 15;
  string customer_name = 16;
  string contact_id = 17;
  string contact_name = 18;


}

message CustomerGetQuoteRequest {}
message CustomerGetQuoteResponse {
}

message CustomerGetShipmentsForOrderRequest {
  string order_id = 1;
}

message CustomerGetShipmentsForOrderResponse {
  repeated SimplifiedShipment shipments = 1;
}

message ListOrdersByCustomerBranchRequest {
  double customer_branch_id = 1;
  Filters filters = 2;
}

message ListOrdersByCustomerBranchResponse {
  repeated BasicOrder orders = 1;
  PageMetadata metadata = 2;
}

message ClerkCreateOrderRequest {}
message ClerkCreateOrderResponse {}

message ListOrdersByCustomerRequest {
  double customer_id = 1;
  Filters filters = 2;

}

message ListOrdersByCustomerResponse {
  repeated BasicOrder orders = 1;
  PageMetadata metadata = 2;
}

message ListOrdersByTakerRequest {
  string taker = 1;
}

message ListOrdersByTakerResponse {
  repeated BasicOrder orders = 1;
}

message ClerkGetOrderRequest {
  string id = 1;
}

message ClerkGetOrderResponse {

  message Item {
    OrderItem base = 1;
  }


  string id = 1;
  repeated Item items = 2;

  string customer_id = 7;
  string customer_name = 8;
  string contact_id = 9;
  string contact_name = 11;

  Address shipping_address = 4;
  string delivery_instructions = 10;
  string taker = 12;
  string purchase_order = 13;

  google.protobuf.Timestamp date_placed = 14;

}

message ClerkCreateQuoteRequest {
  message OrderItem {
    // unique identifier for the product
    int32 product_uid = 1;
    // quantity of the product to be quoted
    double quantity_ordered = 2;
    google.protobuf.Timestamp required_date = 3 [deprecated = true];
  }
  repeated OrderItem order_items = 1;
  // Deprecated: customer_id is pulled from the customer_branch_id
  double customer_id = 2 [deprecated = true];
  // Deprecated: use company_branch_id
  double shipping_address_id= 3 [deprecated = true ];
  // customer accounts contact_id
  string contact_id = 4;
  // date the customer requested the quote to be completed
  google.protobuf.Timestamp requested_date = 5;
  // represents ship_to in prophet and is used as a sub location of a customer record
  double customer_branch_id = 6;
  // instructions pertaining to the delivery of the order
  string delivery_instructions = 7;
  // customer generated purchase order number for this quote
  string purchase_order = 8;

}
message ClerkCreateQuoteResponse {
  // id of the created quote
  string id =1;
}

message ClerkGetShipmentRequest {
  double id = 1;
}
message ClerkGetShipmentResponse {
  double id = 1;
  string order_id = 2;
  string order_purchase_order = 3;
  CustomerContact order_contact = 4;
  Address shipping_address = 5;
  string delivery_instructions = 6;
}

message CustomerListOrdersRequest {}
message CustomerListOrdersResponse {
}
